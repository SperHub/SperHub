{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-md-8">
    <h3>{{ video.title }}</h3>
    <p class="text-muted">par {{ video.uploader }} • {{ video.created_at.split('T')[0] }}</p>

    {% if hls_path %}
      <!-- HLS playback using hls.js -->
      <video id="player" controls style="width:100%; max-height:70vh;"></video>
      <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.5/dist/hls.min.js"></script>
      <script>
        const video = document.getElementById('player');
        const hlsSrc = "{{ hls_path }}";
        if (Hls.isSupported()) {
          const hls = new Hls();
          hls.loadSource(hlsSrc);
          hls.attachMedia(video);
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = hlsSrc;
        } else {
          video.innerHTML = "Lecteur non supporté";
        }
      </script>
    {% else %}
      <div class="alert alert-info">La vidéo est en cours de traitement ou n'est pas encore disponible.</div>
      <img src="{{ thumb_url }}" class="img-fluid" alt="thumb">
    {% endif %}
  </div>

  <div class="col-md-4">
    <h5>Description</h5>
    <p>{{ video.description }}</p>
    <hr>
    <h6>Statut</h6>
    <p>{{ video.status }}</p>
  </div>
</div>
{% endblock %}
